---
title: 成像型毫米波的障碍物检测与跟踪
tags: 毫米波雷达 障碍物检测 障碍物跟踪 无人驾驶 机器人感知
key: MMWObjDetectAndTracking
---

# 成像型毫米波雷达的障碍物检测与跟踪

## ARS408雷达

ARS408雷达说明书如下：

[ARS408英文说明书](https://cdn.jsdelivr.net/gh/gloryhry/imghosting/img/ARS40X_Technical_Documentation_V%201.91_24.01.2018.pdf)

[ARS430中文说明书](https://cdn.jsdelivr.net/gh/gloryhry/imghosting/img/ARS408%E7%B3%BB%E5%88%97%E6%89%8B%E5%86%8C%E4%B8%AD%E6%96%87%E7%89%88.pdf)

ARS408雷达通过CAN总线发出报文，对毫米检测到的障碍物的信息进行通信。
其有两种输出模式，一种是cluster另一种是objects模式。

objects模式中，毫米波对相近的一些cluster点进行聚类，跟踪。通常一个障碍物只给出一个objects的点。
但是在调试中发现，即使毫米波已接入车的CAN并且能正常的获取到车的轮速等姿态信息。但是在使用中，会时常出现未知障碍物从车前横向掠过，实际并没有任何障碍物。
因此只能将毫米波雷达调整至cluster模式，直接输出毫米波雷达获取到的底层cluster数据。

clust模式中，横向掠过的未知障碍物虽然没有了，但是路面上时常冒出毫米波检测到的障碍物点，而且由于驱动中为解析CAN报文中的毫米波点的正确率，这对障碍物的检测与跟踪提出巨大挑战。

而且由于CAN总线的带宽较低，障碍物的cluster被设置的很低，前方的雷达设置的cluster点上限为100，左后和右后的雷达cluster点上限分别设置了50。
如此设置的弊端在车辆前进时就暴露出来，在车辆以大约40km/h速度前进时的检测距离仅不到50米，极大限制了毫米波雷达的感知范围。

## ARS430雷达

ARS430雷达是通过专有网关输出毫米波检测到的障碍物信息。由于是网关输出，因此其带宽能远高于CAN总线的带宽。

ARS430雷达可以同时输出近端和远端的两部分区域的毫米波检测的cluster。

下面是ARS430雷达的相关文档：

[感知开发套件-基础指南](https://cdn.jsdelivr.net/gh/gloryhry/imghosting/img/PDK_KnowledgeBase.pdf)

[感知开发套件-RDI接口](https://cdn.jsdelivr.net/gh/gloryhry/imghosting/img/PDK_RDI_Interface_DRAFT.pdf)

[感知开发套件–接线说明](https://cdn.jsdelivr.net/gh/gloryhry/imghosting/img/%E7%BA%BF%E5%BA%8F%E8%BF%9E%E6%8E%A5_PDK_Wiring_Instructions.pdf)

[MediaGateway用户手册](https://cdn.jsdelivr.net/gh/gloryhry/imghosting/img/MediaGateway-UserManual-V4.2.98-1.pdf)

[用于测试和分析车载网络的开发工具](https://cdn.jsdelivr.net/gh/gloryhry/imghosting/img/TE_Productflyer_2018_print_3mm_10-2.pdf)

## 成像雷达的障碍物检测与跟踪思路

毫米波雷达与激光雷达的工作方式的不同，因此在障碍物检测的方式上具有一些不同。
尽管毫米波雷达与激光雷达的输出都能看做是点云。但是在我看来，毫米波雷达的点云代表了一个区域中存在一个障碍物，而点云的位置应该是这个障碍物区域的中心。
而激光雷达的点云含义应该是当前激光打出去的极小范围的照射区域中存在障碍物。激光雷达的点云可以准确的表示障碍物的外轮廓信息。
而毫米波雷达仅有反射面积这一指标，而且反射面积并不等同于实际障碍物的面积。

毫米波的障碍物检测思路就可以通过其点云表示一定范围存在障碍物这一特性实现。
我们认为毫米波的点云表示了一定面积的障碍物，障碍物的中心处于点云点的位置。在处于车体base_footprint坐标系中的代价地图可以表示各个位置上存在障碍物的可能性，
那就以点云点为中心，通过一定的算法估计出随着距离点云点的长度与存在障碍物可能性的关系式。由此可表达出车体周围存在障碍物可能性的代价地图。

而由于毫米波雷达经常出现误报的随机地面点。我们可以通过叠加4-5帧左右的代价地图来平均计算出障碍物的可能性。若点是误报产生的随机地面点，则这点应该只存在一帧或两帧。
在叠加过后的代价地图中，此点的代价将降低至原来的1/4或1/5左右。而若实际有障碍物的点，在补偿这短时间的位置偏差后，其地代价仍然应为原来的80%以上。
从而能区别出随机出现的地面点和真实存在的障碍物点。

在区别出随机地面点和真实障碍物点后，就可对代价地图通过二值化从而确定高可能性的区域。高可能性区域就认为是障碍物的外轮廓，从其中查找存在的毫米波的点。
从而可以确定出障碍物点与非障碍物点、不同障碍物产生的轮廓和毫米波点。

分离了障碍物点之后就可以对不同的障碍物的性质进行推测。
首先，计算所有障碍物点的平均位置，得到平均位置作为障碍物的中心位置。
然后，计算所有障碍物的合速度，取其中值作为障碍物的速度。
通过轮廓包裹的障碍物点得到的点中有可能有地面的静态点，所以不计算平均速度是为了防止出现静态点从而产生大幅拉低平均速度值的干扰。
